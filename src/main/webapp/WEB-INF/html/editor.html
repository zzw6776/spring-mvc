<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">

    <title>wangEditor mobile test</title>

    <link rel="stylesheet" type="text/css" href="css/wangEditor-mobile.css">

    <style type="text/css">
        .container {
            width:100%; 
            height:300px; 
            border:1px solid #ccc;
        }
    </style>
</head>
<body>
    <p>wangEditor-mobile test</p>


  <div class="container">
        <textarea id="textarea2" name = "meaage" style="width:100%;height:100%;">
            <p>请输入内容...2</p>
        </textarea>
          </div>
    <input id="encryptKey" type="text" name="encryptKey" >
    <input id = "submit" type="button"  value = "提交"/>
  
    
    <script type="text/javascript" src="js/lib/zepto.js"></script>
    <script type="text/javascript" src="js/lib/zepto.touch.js"></script>
    <script type="text/javascript" src="js/wangEditor-mobile.js"></script>
    <script type="text/javascript">
        $(function () {
            // ___E 三个下划线
            var editor = new ___E('textarea2');
            console.log('/fileUpload'+getQueryString('i'));
            editor.config.uploadImgUrl = '/fileUpload?path='+getQueryString('user');
            editor.config.uploadTimeout = 600 * 1000;
            editor.init();
        });
        
        $('#submit').click(function(){
        	var html = $('.wangEditor-mobile-txt').html();
        	var encryptKey = $('#encryptKey').val();
        	 var data = {message:html,encryptKey:encryptKey};
        	  $.post("/diary/insert",data)
        }
        		
        )
        
        function getQueryString(name) {
    var reg = new RegExp('(^|&)' + name + '=([^&]*)(&|$)', 'i');
    var r = window.location.search.substr(1).match(reg);
    if (r != null) {
        return unescape(r[2]);
    }
    return null;
}
    </script>
</body>
</html>